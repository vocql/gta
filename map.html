<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VI | Map</title>
  <link rel="icon" href="gta/npc/lucia.jpg" type="image/jpg">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%;overflow-x:hidden}
    :root{
      --menu-bg-opacity:.32;
      --menu-blur:12px;
      --menu-scale:1;
      --overlay-darkness:.15;
    }
    body{
      font-family:'Orbitron',sans-serif;
      background:
        linear-gradient(135deg, rgba(0,0,0,var(--overlay-darkness)), rgba(0,0,0,var(--overlay-darkness))),
        linear-gradient(135deg, rgba(255,77,210,0.15), rgba(0,255,224,0.10)),
        url('gta/jason.jpg') center/cover no-repeat fixed;
      background-blend-mode:overlay;
      color:#fff;
      min-height:100vh;
    }

    /* ================= MENU ================= */
    .menu-wrap{
      position:fixed;
      top:18px;
      left:18px;
      z-index:55;
      display:flex;
      align-items:flex-start;
    }
    .menu-btn{
      width:46px;
      height:46px;
      border-radius:14px;
      background:rgba(0,0,0,0.32);
      border:1px solid rgba(255,255,255,0.2);
      color:#fff;
      font-size:20px;
      cursor:pointer;
      transition:.2s;
    }
    .menu-btn:hover{transform:scale(1.08)}
    .menu-panel{
      margin-left:14px;
      width:280px;
      padding:18px;
      border-radius:22px;
      background:rgba(0,0,0,var(--menu-bg-opacity));
      backdrop-filter:blur(var(--menu-blur));
      transform:scale(var(--menu-scale));
      border:1px solid rgba(255,255,255,0.18);
      box-shadow:0 18px 40px rgba(0,0,0,0.55);
      display:none;
    }
    .menu-panel.active{display:block}
    .menu-title{
      font-size:11px;
      letter-spacing:2px;
      opacity:.55;
      margin-bottom:10px;
      text-transform:uppercase;
    }
    .menu-link,.toggle{
      display:flex;
      justify-content:space-between;
      padding:10px 14px;
      border-radius:14px;
      background:rgba(255,255,255,0.06);
      margin-bottom:8px;
      color:#fff;
      cursor:pointer;
      text-decoration:none;
      transition:.2s;
    }
    .menu-link:hover,.toggle:hover{
      background:rgba(255,255,255,0.16);
    }

    /* ================= SETTINGS PANEL ================= */
    .settings-panel{
      margin-left:14px;
      width:320px;
      padding:18px;
      border-radius:22px;
      background:rgba(0,0,0,0.45);
      backdrop-filter:blur(16px);
      border:1px solid rgba(255,255,255,0.2);
      box-shadow:0 22px 50px rgba(0,0,0,.65);
      display:none;
    }
    .settings-panel.active{display:block}
    .setting{margin-bottom:16px;}
    .setting label{
      font-size:12px;
      opacity:.8;
      display:block;
      margin-bottom:6px;
    }
    .setting input[type=range]{width:100%;}

    /* ====== Page Content ====== */
    .page {
      width: clamp(900px,88vw,1400px);
      height: calc(100vh - 140px);
      margin: 100px auto 40px;
      display: flex;
      flex-direction: column;
    }
    .embed-card {
      flex: 1;
      border-radius: 20px;
      overflow: hidden;
      background: linear-gradient(180deg, rgba(0,0,0,0.28), rgba(0,0,0,0.22));
      border: 1px solid rgba(255,255,255,0.04);
      box-shadow: 0 30px 80px rgba(0,0,0,0.5);
      display: flex;
      flex-direction: column;
    }
    .embed-header {
      padding: 18px 22px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .embed-title {
      font-size: 20px;
      font-weight: 900;
      color: rgba(255,255,255,0.95);
    }
    .embed-frame {
      flex: 1;
      border: 0;
      width: 100%;
      background: #111;
    }

    @media(max-width:760px){
      .page { width:96vw; margin-top:90px; }
      .embed-header { padding:14px; }
      .embed-title { font-size:16px; }
    }
  </style>
</head>
<body>

<audio id="bgMusic" loop>
  <source src="music/night.mp3" type="audio/mpeg">
</audio>

<div class="menu-wrap">
  <button class="menu-btn">☰</button>
  <div class="menu-panel" id="menuPanel">
    <div class="menu-title">Pages</div>
    <a class="menu-link" href="index">Home</a>
    <a class="menu-link" href="map">Map</a>
    <a class="menu-link" href="characters">Characters</a>
    <a class="menu-link" href="places">Places</a>
    <a class="menu-link" href="screenshots">Screenshots</a>
    <a class="menu-link" href="trailers">Trailers</a>
    <div class="menu-title" style="margin-top:14px">Settings</div>
    <div class="toggle" id="musicToggle">
      Soundtrack <span id="musicState">OFF</span>
    </div>
    <div class="toggle" id="openSettings">Menu Settings →</div>
  </div>
  <div class="settings-panel" id="settingsPanel">
    <div class="menu-title">Menu Visibility</div>
    <div class="setting">
      <label>Menu Opacity</label>
      <input type="range" min="0.15" max="0.8" step="0.01" id="menuOpacity" value="0.32">
    </div>
    <div class="setting">
      <label>Menu Blur</label>
      <input type="range" min="0" max="24" step="1" id="menuBlur" value="12">
    </div>
    <div class="setting">
      <label>Menu Scale</label>
      <input type="range" min="0.9" max="1.05" step="0.01" id="menuScale" value="1">
    </div>
    <div class="setting">
      <label>Background Darkening</label>
      <input type="range" min="0" max="0.4" step="0.01" id="bgDark" value="0.15">
    </div>
  </div>
</div>

<div class="page">
  <div class="embed-card">
    <div class="embed-header">
      <div class="embed-title">Grand Theft Auto VI Map</div>
    </div>
    <iframe class="embed-frame"
      src="https://map.stateofleonida.net/"
      allowfullscreen
      sandbox="allow-same-origin allow-scripts allow-forms allow-popups"
    ></iframe>
  </div>
</div>

<script>
// MENU & SETTINGS
const menuBtn = document.querySelector('.menu-btn');
const menuPanel = document.getElementById('menuPanel');
const settingsPanel = document.getElementById('settingsPanel');

document.addEventListener('click', e => {
  if (!e.target.closest('.menu-wrap')) {
    menuPanel.classList.remove('active');
    settingsPanel.classList.remove('active');
  }
});

menuPanel.addEventListener('click', e => e.stopPropagation());
settingsPanel.addEventListener('click', e => e.stopPropagation());

menuBtn.onclick = e => {
  e.stopPropagation();
  menuPanel.classList.toggle('active');
};

document.getElementById('openSettings').onclick = e => {
  e.stopPropagation();
  settingsPanel.classList.toggle('active');
};

// MUSIC
const music = document.getElementById('bgMusic');
const musicToggle = document.getElementById('musicToggle');
const musicState = document.getElementById('musicState');
let musicOn = false;
let unlocked = false;

function unlockAudio() {
  if (unlocked) return;
  music.volume = 0.35;
  music.play().then(() => music.pause()).catch(() => {});
  unlocked = true;
}

document.addEventListener('pointerdown', unlockAudio, {once: true});

musicToggle.onclick = e => {
  e.stopPropagation();
  unlockAudio();
  musicOn = !musicOn;
  if (musicOn) {
    music.play();
    musicState.textContent = 'ON';
  } else {
    music.pause();
    musicState.textContent = 'OFF';
  }
};

// SETTINGS
const root = document.documentElement;
const save = (key, value) => localStorage.setItem(key, value);
const load = (key, def) => localStorage.getItem(key) || def;

const menuOpacity = document.getElementById('menuOpacity');
const menuBlur = document.getElementById('menuBlur');
const menuScale = document.getElementById('menuScale');
const bgDark = document.getElementById('bgDark');

menuOpacity.value = load('menuOpacity', '0.32');
menuBlur.value   = load('menuBlur', '12');
menuScale.value  = load('menuScale', '1');
bgDark.value     = load('bgDark', '0.15');

function applySettings() {
  root.style.setProperty('--menu-bg-opacity', menuOpacity.value);
  root.style.setProperty('--menu-blur', menuBlur.value + 'px');
  root.style.setProperty('--menu-scale', menuScale.value);
  root.style.setProperty('--overlay-darkness', bgDark.value);
}

[menuOpacity, menuBlur, menuScale, bgDark].forEach(input => {
  input.addEventListener('input', () => {
    save(input.id, input.value);
    applySettings();
  });
});

applySettings();
</script>
</body>
</html>
